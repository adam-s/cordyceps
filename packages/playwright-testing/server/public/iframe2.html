<!doctype html>
<html>

<head>
  <title>Iframe 2 - Content with Nested Iframe</title>
  <meta charset="utf-8" />
  <style>
    body {
      font-family: -apple-system, system-ui, BlinkMacSystemFont, "Segoe UI", sans-serif;
      padding: 1em;
      background-color: #fff3e0;
      margin: 0;
    }

    .iframe-content {
      background: white;
      padding: 1em;
      border-radius: 0.25em;
      border: 1px solid #ffb74d;
    }

    .nested-iframe-container {
      margin: 1em 0;
      padding: 0.5em;
      background-color: #ffe0b2;
      border-radius: 0.25em;
    }

    iframe {
      width: 100%;
      height: 120px;
      border: 1px solid #ff9800;
      border-radius: 0.25em;
    }

    button {
      background-color: #ff9800;
      color: white;
      border: none;
      padding: 0.5em 1em;
      border-radius: 0.25em;
      cursor: pointer;
      margin: 0.5em 0;
    }

    button:hover {
      background-color: #f57c00;
    }
  </style>
</head>

<body>
  <div class="iframe-content">
    <h3>üñºÔ∏è Iframe 2 with Nested Content</h3>
    <p>This iframe contains another nested iframe inside it!</p>

    <label>
      <input type="checkbox" id="iframe2-checkbox" checked> Iframe 2 Checkbox
      (pre-checked)
    </label>
    <br>
    <button onclick="iframe2Action()">Iframe 2 Button</button>

    <div class="nested-iframe-container">
      <h4>üì¶ Nested Iframe:</h4>
      <iframe src="/nested-iframe"
        title="Nested iframe inside iframe 2"></iframe>
    </div>

    <p id="iframe2-status">Status: Ready with nested content</p>
  </div>

  <script>
    function iframe2Action() {
      const checkbox = document.getElementById('iframe2-checkbox');
      const status = document.getElementById('iframe2-status');
      const timestamp = new Date().toLocaleTimeString();

      status.textContent = `Status: Iframe 2 button clicked at ${timestamp}, Checkbox: ${checkbox.checked ? 'Checked' : 'Unchecked'}`;
      console.log('üéØ Iframe 2 button clicked');

      // Send message to parent
      window.parent.postMessage({
        source: 'iframe2',
        action: 'button-click',
        checkboxState: checkbox.checked,
        timestamp: timestamp,
        hasNestedIframe: true
      }, '*');
    }

    // Listen for messages from parent and nested iframe
    window.addEventListener('message', function (event) {
      console.log('üì® Iframe 2 received message:', event.data);

      // If message is from nested iframe, forward to parent
      if (event.data.source === 'nested-iframe') {
        window.parent.postMessage({
          source: 'iframe2-forwarding',
          originalMessage: event.data
        }, '*');
      }
    });

    document.addEventListener('DOMContentLoaded', function () {
      console.log('üöÄ Iframe 2 loaded with nested iframe');
    });
  </script>
</body>

</html>